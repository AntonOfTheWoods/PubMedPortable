<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>PubMed2Go</title>
  <link rel="stylesheet" href="/home/kersten/.pandoc/format.css" type="text/css" />
</head>
<body>
<div id="header">
<h1 class="title">PubMed2Go</h1>
</div>
<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#download-a-data-set"><span class="toc-section-number">2</span> Download a Data Set</a></li>
<li><a href="#installation"><span class="toc-section-number">3</span> Installation</a><ul>
<li><a href="#operation-system"><span class="toc-section-number">3.1</span> Operation System</a><ul>
<li><a href="#ubuntu"><span class="toc-section-number">3.1.1</span> Ubuntu</a></li>
<li><a href="#fedora"><span class="toc-section-number">3.1.2</span> Fedora</a></li>
<li><a href="#windows"><span class="toc-section-number">3.1.3</span> Windows</a></li>
</ul></li>
<li><a href="#creation-of-postgresql-superuser"><span class="toc-section-number">3.2</span> Creation of PostgreSQL superuser</a></li>
<li><a href="#installation-with-docker"><span class="toc-section-number">3.3</span> Installation with Docker</a></li>
</ul></li>
<li><a href="#build-up-a-relational-database-in-postgresql"><span class="toc-section-number">4</span> Build up a Relational Database in PostgreSQL</a></li>
<li><a href="#build-up-a-full-text-index-with-xapian-and-search-it"><span class="toc-section-number">5</span> Build up a Full Text Index with Xapian and Search It</a></li>
<li><a href="#examples-for-connecting-full-text-search-and-selection-of-data-from-postgresql"><span class="toc-section-number">6</span> Examples for Connecting Full Text Search and Selection of Data from PostgreSQL</a><ul>
<li><a href="#xapian"><span class="toc-section-number">6.1</span> Xapian</a></li>
<li><a href="#postgresql"><span class="toc-section-number">6.2</span> PostgreSQL</a></li>
<li><a href="#postgresql-and-xapian"><span class="toc-section-number">6.3</span> PostgreSQL and Xapian</a></li>
</ul></li>
<li><a href="#contact"><span class="toc-section-number">7</span> Contact</a><ul>
<li><a href="#license"><span class="toc-section-number">7.1</span> License</a></li>
</ul></li>
</ul>
</div>
<h1 id="introduction"><a href="#TOC"><span class="header-section-number">1</span> Introduction</a></h1>
<ul>
<li><p>PubMed2Go processes XML files that can be downloaded from NCBI and builds up a PostgreSQL database containing all abstracts of the data set (no full texts).</p></li>
<li><p>Furthermore, PubMed2Go generates a full text index with Xapian such that titles, abstracts, keywords, MeSH terms and substances can be queried with search terms.</p></li>
<li><p>It is scalable to your system requirements using multiprocessing and can be modified easily to your personal needs.</p></li>
<li><p>This documentation refers to a text mining example using the disease pancreatic cancer. It contains many small examples how to use PostgreSQL and Xapian as well as connecting both with small Python programmes. The default values in the scripts refer to the parameters given here, but all of them can be changed by the user.</p></li>
<li><p>If the examples from this documentations are used, there will be around 670 MB of disk space needed. There are no other hardware requirements.</p></li>
<li><p>Start by copying the whole project folder from GitHub to your local disk.</p></li>
</ul>
<h1 id="download-a-data-set"><a href="#TOC"><span class="header-section-number">2</span> Download a Data Set</a></h1>
<ul>
<li><p>Type in the following URL into your browser and search for “pancreatic cancer”:</p>
<blockquote>
<ul>
<li><p><a href="http://www.ncbi.nlm.nih.gov/pubmed">http://www.ncbi.nlm.nih.gov/pubmed</a>/</p></li>
<li><p>The quote signs are important for the exact search.</p></li>
<li><p>Click on “Send to:” and “File” and select “XML”.</p></li>
<li><p>10th July 2014: 21482 PubMed-IDs</p>
<blockquote>
<ul>
<li>Some PubMed-IDs might change over time. Even for the given example list of PubMed-IDs for this documentation in “data/pubmed_result.txt” it is possible, that you receive another number of downloaded publications in your XML files as well as different outcomes in the ongoing analyes.</li>
</ul>
</blockquote></li>
<li><p>The download of around 230 MB can take up to one hour depending on the time of day and internet connection.</p></li>
</ul>
</blockquote></li>
<li><p>Another possibility is to download PubMed articles with EFetch:</p>
<blockquote>
<ul>
<li><p>How to build a query:</p>
<blockquote>
<ul>
<li><p><a href="http://www.ncbi.nlm.nih.gov/books/NBK25499/#chapter4.EFetch">http://www.ncbi.nlm.nih.gov/books/NBK25499/#chapter4.EFetch</a></p></li>
<li><p><a href="http://www.ncbi.nlm.nih.gov/books/NBK25501">http://www.ncbi.nlm.nih.gov/books/NBK25501</a>/</p></li>
</ul>
</blockquote></li>
<li><p>You can also download only the PubMed-ID list from your browser by selecting “PMID List” instead of “XML” and then use EFetch (tested only on Ubuntu):</p>
<blockquote>
<ul>
<li><p>Change into the directory “data” in your command-line and type in “python generate_efetch.py”. It will build the script “efetch.sh” which generates XML files with 100 PubMed-IDs in each document.</p></li>
<li><p>The standard input filename is “pubmed_result.txt” and the block size of PubMed-IDs for one XML file is 100, but this can be changed. Type in “python generate_efetch.py -h” to show adjustable parameters.</p></li>
<li><p>If you want to specify the name of the directory where the XML files should be saved, use parameter “-d” and create this folder manually before.</p></li>
<li><p>The file “data/pubmed_result.txt” contains 21482 PubMed-IDs and the first 100 PubMed-IDs are saved in “data/pancreatic_cancer_example/medline_00000000.xml” as an example.</p></li>
<li><p>Make “efetch.sh” executable with “chmod +x efetch.sh” in the command-line and run it in a folder of your choice by typing in “./efetch.sh”.</p></li>
<li><p>This will be faster than using the browser to download a single XML file and it has the advantage of using multiprocessing in the next step as the script generates XML files with 100 titles in each document. The command also works with blocks of 500 PubMed-IDs, but not 1000.</p></li>
</ul>
</blockquote></li>
</ul>
</blockquote></li>
<li><p>It is also possible to download the whole MEDLINE/PubMed via license:</p>
<blockquote>
<ul>
<li><p><a href="http://www.nlm.nih.gov/databases/license/license.html">http://www.nlm.nih.gov/databases/license/license.html</a></p></li>
<li><p><a href="http://www.nlm.nih.gov/bsd/licensee/2013_stats/baseline_doc.html">http://www.nlm.nih.gov/bsd/licensee/2013_stats/baseline_doc.html</a></p></li>
</ul>
</blockquote></li>
<li><p>You can insert the XML files in an extra directory in your project folder “data” or somewhere else. The only important thing is to use only one type of topic or XML files in one folder, because the programme will insert all files of type XML in a directory into the database given (next step).</p></li>
</ul>
<h1 id="installation"><a href="#TOC"><span class="header-section-number">3</span> Installation</a></h1>
<h2 id="operation-system"><a href="#TOC"><span class="header-section-number">3.1</span> Operation System</a></h2>
<ul>
<li>PubMed2Go was tested on Ubuntu, Fedora, and Windows.</li>
</ul>
<h3 id="ubuntu"><a href="#TOC"><span class="header-section-number">3.1.1</span> Ubuntu</a></h3>
<ul>
<li><p>These are the packages that need to be installed to use PubMed2Go:</p>
<blockquote>
<ul>
<li><p>python&gt;=2.7.3</p></li>
<li><p>postgresql&gt;=8.4</p></li>
<li><p>python-xappy&gt;=0.5</p></li>
<li><p>python-xapian&gt;=1.2.8</p></li>
<li><p>python-sqlalchemy&gt;=0.9.7</p></li>
<li><p>python-psycopg2&gt;=2.4.5 (dependency from SQLAlchemy)</p></li>
<li><p>To install, the following command can be used in the Ubuntu terminal:</p>
<blockquote>
<ul>
<li>“sudo apt-get install”</li>
</ul>
</blockquote></li>
</ul>
</blockquote></li>
<li><p>If you use an older Ubuntu version, you can use “pip” to upgrade your package versions specifically for your user name, e.g.:</p>
<blockquote>
<ul>
<li>“sudo pip install sqlalchemy –upgrade”</li>
</ul>
</blockquote></li>
</ul>
<h3 id="fedora"><a href="#TOC"><span class="header-section-number">3.1.2</span> Fedora</a></h3>
<ul>
<li><p>This section describes how to install required packages and how to adjust PostgreSQL settings in Fedora.</p></li>
<li><p>To install the Fedora packages use the following command. It will install all required packages:</p>
<blockquote>
<ul>
<li>“sudo -E yum install python python-xappy python-sqlalchemy python-psycopg2 postgresql postgresql-server postgresql-contrib”</li>
</ul>
</blockquote></li>
<li><p>To enable PostgreSQL in Fedora, use the following steps:</p>
<blockquote>
<ul>
<li><p>“sudo systemctl enable postgresql”</p></li>
<li><p>To start postgresql use the following command</p>
<blockquote>
<ul>
<li>“sudo systemctl start postgresql”</li>
</ul>
</blockquote></li>
<li><p>To populate initial data, the following command is required:</p>
<blockquote>
<ul>
<li>“journalctl -xn”</li>
</ul>
</blockquote></li>
<li><p>To initialise database, use the following command:</p>
<blockquote>
<ul>
<li>“sudo postgresql-setup initdb”</li>
</ul>
</blockquote></li>
<li><p>To allow read access to postgres, SELinux should be modified. This can be done with the following command:</p>
<blockquote>
<ul>
<li>“grep postgres /var/log/audit/audit.log | audit2allow -M mypol”</li>
</ul>
</blockquote></li>
<li><p>Then you can do this:</p>
<blockquote>
<ul>
<li>“sudo semodule -i mypol.pp”</li>
</ul>
</blockquote></li>
<li><p>Append this line in the file “pg_hba.conf” (default location: “/var/lib/pgsql/data/pg_hba.conf”):</p>
<blockquote>
<ul>
<li><p>“host all all 0.0.0.0 0.0.0.0 trust”</p></li>
<li><p>If “trust” is used instead of “ident”, you are allowed to use a password. “0.0.0.0” means that all machines are allowed to login. That means, if you want to customise which server has to reach the database, you can control it here.</p></li>
</ul>
</blockquote></li>
</ul>
</blockquote></li>
</ul>
<h3 id="windows"><a href="#TOC"><span class="header-section-number">3.1.3</span> Windows</a></h3>
<ul>
<li>&lt;will follow soon&gt;</li>
</ul>
<h2 id="creation-of-postgresql-superuser"><a href="#TOC"><span class="header-section-number">3.2</span> Creation of PostgreSQL superuser</a></h2>
<ul>
<li><p>If there is not yet a superuser for the PostgreSQL database, create one with the name of your local account</p>
<blockquote>
<ul>
<li><p>“sudo -u postgres createuser --superuser &lt;user_name&gt;”</p></li>
<li><p>“sudo -u &lt;user_name&gt; psql template1”</p>
<blockquote>
<ul>
<li><p>\password &lt;press enter, type in password, and press enter, again&gt;</p></li>
<li><p>\q</p></li>
</ul>
</blockquote></li>
</ul>
</blockquote></li>
<li><p>Now, you can connect to the standard PostgreSQL database “postgres” with PGAdmin3 or via command-line:</p>
<blockquote>
<ul>
<li>“psql -h localhost -d postgres -U &lt;user_name&gt;”</li>
</ul>
</blockquote></li>
</ul>
<h2 id="installation-with-docker"><a href="#TOC"><span class="header-section-number">3.3</span> Installation with Docker</a></h2>
<ul>
<li><p>Docker is similar to a virtual machine, but it can be configured to be much smaller.</p></li>
<li><p>You can use the PubMed2Go image to create a PostgreSQL relational database and a Xapian full text index without installing the packages mentioned above in basically two steps.</p></li>
<li><p>Install Docker - it was tested on Ubuntu:</p>
<blockquote>
<ul>
<li><p><a href="https://docs.docker.com/installation/ubuntulinux/#ubuntu-precise-1204-lts-64-bit">https://docs.docker.com/installation/ubuntulinux/#ubuntu-precise-1204-lts-64-bit</a></p></li>
<li><p>There are many different operation systems supported:</p>
<blockquote>
<ul>
<li><a href="https://docs.docker.com/installation/#installation">https://docs.docker.com/installation/#installation</a></li>
</ul>
</blockquote></li>
</ul>
</blockquote></li>
<li><p>Run Docker with the PubMed2Go image:</p>
<blockquote>
<ul>
<li><p>Create a folder on your local disk with a name of your choice.</p></li>
<li><p>Go into that folder and create a directory “import_data”.</p></li>
<li><p>Copy you XML files downloaded from PubMed into the directory “import_data”.</p></li>
<li><p>Open a terminal and type in this command:</p>
<blockquote>
<ul>
<li><p>“sudo docker run -d -v /home/&lt;user_name&gt;/&lt;folder_of_your_choice&gt;/:/export/ -p 9999:5432 bgruening/pubmed2go”</p></li>
<li><p>This will create the PostgreSQL folder as well as the full text index database folder within the &lt;folder_of_your_choice&gt;.</p></li>
<li><p>You can see that Docker is running by typing in “sudo docker ps”. This will show a randomly generated name for your process.</p></li>
<li><p>Stopping Docker is possible by doing “sudo docker stop &lt;name&gt;”.</p></li>
<li><p>Docker maps your PosgreSQL port “5432” to the port “9999”. Now, you can connect to your database with PGAdmin via “localhost”, port “9999” and user “parser” with password “parser”.</p></li>
<li><p>If you have created another folder with a name &lt;folder_of_your_choice&gt; with the directory “import_data”, you can create another database on port “9998” and another full text index with different data there.</p></li>
</ul>
</blockquote></li>
</ul>
</blockquote></li>
<li><p>You do not have to have a PostgreSQL installation on your operation system if docker is running in background. Restart a session with this command:</p>
<blockquote>
<ul>
<li>“sudo docker run -d -v /home/kersten/docker/foo/:/export/ -p 9999:5432 bgruening/pubmed2go”</li>
</ul>
</blockquote></li>
<li><p>It is not recommended to run the PubMed2Go examples or to develop new scripts within the Docker container. If you want to modify the image, use the Docker documentation and this repository:</p>
<blockquote>
<ul>
<li><a href="https://github.com/bgruening/docker-recipes/tree/master/pubmed2go">https://github.com/bgruening/docker-recipes/tree/master/pubmed2go</a></li>
</ul>
</blockquote></li>
<li><p>If you want to try the examples given in the section 5 and 6, copy the Xapian directory from the &lt;folder_of_your_choice&gt; into the folder “PubMed2Go/full_text_index/xapian/” from “<a href="https://github.com/KerstenDoering/PubMed2Go">https://github.com/KerstenDoering/PubMed2Go</a>” and run the Docker container in background. You can completely skip section 4.</p></li>
<li><p>You can connect to PostgreSQL and Xapian with the programming language of your choice or follow the Python examples given in this documentation. If you want to develop your own text mining pipelines based on your data set of choice, you will have to install the required libraries on your operation system.</p></li>
</ul>
<h1 id="build-up-a-relational-database-in-postgresql"><a href="#TOC"><span class="header-section-number">4</span> Build up a Relational Database in PostgreSQL</a></h1>
<ul>
<li><p>Open a Terminal and type in:</p>
<blockquote>
<ul>
<li>“psql template1”</li>
</ul>
</blockquote></li>
<li><p>Enter the following commands into psql prompt to create a database, the schema “pubmed”, and a standard user “parser”. It is important to write the user “parser” in single quotes in the creation step:</p>
<blockquote>
<ul>
<li><p>CREATE USER parser WITH PASSWORD 'parser';</p></li>
<li><p>CREATE DATABASE pancreatic_cancer_db;</p></li>
<li><p>GRANT ALL PRIVILEGES ON DATABASE pancreatic_cancer_db to parser;</p></li>
<li><p>\q</p></li>
</ul>
</blockquote></li>
<li><p>Now you can create a schema “pubmed” as user “parser”. You will be asked to enter your password “parser” here:</p>
<blockquote>
<ul>
<li>“psql -h localhost -d pancreatic_cancer_db -U parser -f create_schema.sql”</li>
</ul>
</blockquote></li>
<li><p>If you want to use another database name, just change “pancreatic_cancer_db” in these commands and provide this name in all other scripts by choosing the right parameter.</p></li>
<li><p>It is recommended to use the name “parser” with password “parser” and the schema “pubmed”, because this is hard coded in “PubMedDB.py” and “PubMedParser.py”</p></li>
<li><p>Create the tables in your database schema “pubmed” like this:</p>
<blockquote>
<ul>
<li>Use the command “python PubMedDB.py -d pancreatic_cancer_db” in your terminal. There are no other parameters that can be set.</li>
</ul>
</blockquote></li>
<li><p>Load the data from PubMed into your PostgreSQL database:</p>
<blockquote>
<ul>
<li><p>You can check “python PubMedParser.py -h” to get a help screen with all adjustable parameters. If you want to use the defaults, you can simply type in “python PubMedParser.py”.</p>
<blockquote>
<ul>
<li><p>By default, previously in PostgreSQL inserted data will be deleted before loading the new XML files into the database. That means you just have to call “python PubMedParser.py”, again in case you want to load new data into your already created database.</p></li>
<li><p>If you do not want to delete, but only add XML files to the data that is already inside your PostgreSQL database, use parameter “-c”.</p></li>
<li><p>The default database name is “pancreatic_cancer_db” and the default number of processors is 2. For changing, use parameters “-d” and “-p”.</p></li>
<li><p>If you want to process only part of your files, use the parameters “-s” and “-e” with numbers referring to your alphabetically sorted files, e.g. “-s 0 -e 20” for the first 20 XML files in the directory.</p></li>
</ul>
</blockquote></li>
<li><p>It is important that you only type in the name of the folder containing all XML files with parameter “-i”, but not the name of the file(s). You do not need to type in the absolute path. Suppose, you have saved your XML file(s) in the directory “data/pancreatic_cancer”, use this command to run it with 4 processors and the database “pancreatic_cancer_db”:</p>
<blockquote>
<ul>
<li>“python PubMedParser.py -i data/pancreatic_cancer/ -d pancreatic_cancer_db -p 4”</li>
</ul>
</blockquote></li>
<li><p>If you receive an error concerning too many database connections, make sure that you use the latest version of SQLAlchemy. In earlier versions, sometimes the database connections were closed by the programme, but still remained open for some seconds, preventing the new programme to open a new connection. You can also increase the number of possible connections to your PostgreSQL server that can be opened (Ubuntu: “max_connections = &lt;type in number&gt;” in “/etc/postgresql/&lt;version number&gt;/main/postgresql.conf”).</p></li>
<li><p>For one file with around 230 MB this takes around 10 min (only one processor can be used). For the same amount of data split into files with only 100 PubMed-IDs (use “generate_efetch.py”) it takes around 3 min with 4 processors (2,83 GHz and 8 GB RAM).</p></li>
</ul>
</blockquote></li>
<li><p>Now, a schema “pubmed” exists in your database “pancreatic_cancer_db” that contains all abstracts, titles, authors, etc. More information will be given in section 5, containing SQL queries and small programming examples.</p></li>
</ul>
<h1 id="build-up-a-full-text-index-with-xapian-and-search-it"><a href="#TOC"><span class="header-section-number">5</span> Build up a Full Text Index with Xapian and Search It</a></h1>
<ul>
<li><p>The results from this section can be found in “full_text_index/results/results_from_documentation/”.</p></li>
<li><p>Change into the directory “full_text_index” in your terminal.</p></li>
<li><p>Create two directories, “xapian” and “results”, if they do not yet exist.</p></li>
<li><p>Type in “python RunXapian.py -h” to get a help screen with all adjustable parameters.</p></li>
<li><p>If you use all default values from this documentation, you will receive results in “results/results.csv” with “python RunXapian.py -x”.</p>
<blockquote>
<ul>
<li><p>This command indexes all titles, abstracts, keywords, MeSH terms and substances from year 1809 to 2014, downloaded as XML files from PubMed (as described in section “Download a Data Set”).</p>
<blockquote>
<ul>
<li><p>There are no abstracts with a publication date before 1809:</p></li>
<li><p><a href="http://www.nlm.nih.gov/bsd/licensee/2014_stats/baseline_med_filecount.html">http://www.nlm.nih.gov/bsd/licensee/2014_stats/baseline_med_filecount.html</a></p></li>
</ul>
</blockquote></li>
<li><p>After completing the step of generating the full text index, the programme searches it with the synonyms given in “synonyms/pancreatic_cancer.txt”.</p>
<blockquote>
<ul>
<li>This file contains manually chosen names of drugs, genes, proteins, and diseases related to pancreatic cancer.</li>
</ul>
</blockquote></li>
<li><p>The output in the command-line shows how many PubMed-IDs are indexed (21482) and how many synonyms are searched (86).</p></li>
<li><p>This takes around 2 min on a 2,83 GHz machine with 8 GB RAM.</p></li>
<li><p>You can also select single years for indexing and searching.</p></li>
<li><p>If you just want to index your XML files, type in “python RunXapian.py -x -f”. (Parameter “-f” turns off the search function of the programme, default is “True”.)</p></li>
<li><p>If you just want to search your synonyms, type in “python RunXapian.py” (Parameter “-x” turns on the indexing step, default is “False”.)</p></li>
<li><p>The default location for your full text index database folder is “PubMed2Go/full_text_index/xapian/&lt;xapian2014&gt;”. You can change this location by using the parameter “-p”.</p></li>
</ul>
</blockquote></li>
<li><p>For the given example, 9299 lines were generated in “results.csv”. Run “python summary.py” to get two CSV files in directory “results”. If you have chosen another filename as output from “RunXapian.py”, you can do “python summary.py -f &lt;name_of_input_file.csv&gt;”:</p>
<blockquote>
<ul>
<li><p>Drug synonyms were taken from DrugBank using the exact search query “pancreatic cancer”:</p>
<blockquote>
<ul>
<li><a href="http://www.drugbank.ca">http://www.drugbank.ca</a>/</li>
</ul>
</blockquote></li>
<li><p>Protein and gene synonyms have been extracted manually from OMIM also performing an exact search:</p>
<blockquote>
<ul>
<li><a href="http://omim.org/entry/260350?search=%22pancreatic%20cancer%22">http://omim.org/entry/260350?search=%22pancreatic%20cancer%22</a></li>
</ul>
</blockquote></li>
<li><p>Other diseases related to pancreatic cancer have been taken the text given on OMIM, too.</p></li>
<li><p>“counts_results.csv” shows how many synonyms were found (descending - 64 lines, meaning 64 from a total of 86 search terms). The alternative input filename will be “counts_&lt;input_file.csv&gt;”.</p>
<blockquote>
<ul>
<li><p>Taking into account the drugs, gemcitabine shows the most hits (2644). Erlotinib was found in 280 publications. Other approved drugs like WF10 and hydroxocobalamin were not found. Many investigational drugs were found 1-10 times: R115777, G17DT, hedgehog pathway inhibitor, imexon, GV1001, RP101, MGI-114, and PX-12. No other substances given on DrugBank were identified in this data set.</p></li>
<li><p>Pancreatic ductal adenocarcinoma is the most common type of pancreatic cancer ( <a href="http://www.cancer.gov/aboutnci/budget_planning_leg/plan-2013/profiles/pancreatic">http://www.cancer.gov/aboutnci/budget_planning_leg/plan-2013/profiles/pancreatic</a> ), which is shown by the 1333 hits. The tumor suppressor protein p53 was found 620 times, but also associated genes like KRAS, SMAD4, BRCA2, mTOR and CDKN2A were found (122-344 times). Many other genes were identified with a number below 10 hits and can be further analysed in “pmids_results.csv”.</p></li>
<li><p>Associated diseases like breast cancer, colon cancer, ovarian cancer and diabetes were found 230-36 times.</p></li>
</ul>
</blockquote></li>
<li><p>“pmids_results.csv” shows which synonyms co-occur in the same abstract or title, sorted by PubMed-IDs (6745 lines). In case of an alternative input filename, there will be the resulting file “pmids_&lt;input_file.csv&gt;”.</p></li>
</ul>
</blockquote></li>
<li><p>In case, you want to index the whole PubMed, it can be useful to index blocks of years or every year as a single directory. Like this, it is possible to use multiprocessing and decrease RAM usage. Just run the programme in different shells or on different machines and copy all resulting index folders to the same main directory. The tool “xapian-compact” summarises all generated directories to one full text index:</p>
<blockquote>
<ul>
<li><p><a href="http://xapian.org/docs/admin_notes.html#merging-databases">http://xapian.org/docs/admin_notes.html#merging-databases</a></p></li>
<li><p>xapian-compact -m &lt;all input directories to be compressed, separated by space&gt; &lt;name of outcoming folder with complete database&gt;</p></li>
</ul>
</blockquote></li>
</ul>
<h1 id="examples-for-connecting-full-text-search-and-selection-of-data-from-postgresql"><a href="#TOC"><span class="header-section-number">6</span> Examples for Connecting Full Text Search and Selection of Data from PostgreSQL</a></h1>
<h2 id="xapian"><a href="#TOC"><span class="header-section-number">6.1</span> Xapian</a></h2>
<ul>
<li><p>Use the following scripts to work with the functions OR, AND, NEAR, ADJ, NOT, and phrase search in Xapian and have a look at the HTML output files. As the number of PubMed-IDs increases continuously, the resulting numbers in this documentation can be seen as a reference point for the given query “pancreatic cancer”. Having a look at these scripts as well as “RunXapian.py” can be useful to build your own modified queries. There is also a small note in “full_text_index/xapian/readme.txt”.</p>
<blockquote>
<ul>
<li><p>“python search_title.py” shows that only a few lines of code are required to search only publication titles. This can be important as searching especially in publication titles puts more emphasis on the queried synonyms.</p>
<blockquote>
<ul>
<li><p>While “RunXapian.py” searches only the exact phrase “pancreatic cancer”, “search_title.py” searches for the stem “pancreat” and also finds the word “pancreatitis”.</p></li>
<li><p>It generates “Xapian_query_results.html” which shows the first 1000 of 16674 titles. Like this, many associated words are shown, e.g. “pancreatic ductal adenocarcinoma” or “pancreatic diseases”.</p></li>
</ul>
</blockquote></li>
<li><p>To further specify your search, you can query titles containing “pancreatic cancer” and the drug “erlotinib” with “python search_near_title.py”.</p>
<blockquote>
<ul>
<li><p>This generates 32 results in “Xapian_query_results_NEAR.html”.</p></li>
<li><p>In this case “NEAR/5” is used as a Xapian function. “NEAR” is keeping the synonym order, but only a maximum of 4 words is allowed to be between the two search terms.</p></li>
<li><p>An alternative would be the query with “ADJ/5”, which reduces the number of 32 hits, because with this function, the order of search terms is fixed.</p></li>
<li><p>Here, the exact search is performed, again.</p></li>
</ul>
</blockquote></li>
<li><p>As it was done in “RunXapian.py” different index fields can be searched.</p>
<blockquote>
<ul>
<li><p>“python search_title_or_text.py” searches documents in which the drug “R115777” occurs in the title or the text.</p></li>
<li><p>As shown in “counts_results.csv”, only 10 hits can be found. The matching titles and abstracts can be seen in “Xapian_query_results_OR.html”.</p></li>
</ul>
</blockquote></li>
<li><p>The script “python search_not_title_or_text.py” specifies the query to documents not containing the terms “colon”, “lung”, or “ovarian”, but the word “pancreatic”.</p>
<blockquote>
<ul>
<li><p>This reduces the number of results to 9 hits, as no publications are considered that contain these other types of cancer.</p></li>
<li><p>The result is shown in “Xapian_query_results_NOT.html”.</p></li>
</ul>
</blockquote></li>
<li><p>In this way, different search queries can be combined with a few lines of code.</p></li>
</ul>
</blockquote></li>
</ul>
<h2 id="postgresql"><a href="#TOC"><span class="header-section-number">6.2</span> PostgreSQL</a></h2>
<ul>
<li><p>Type in these SQL queries in PGAdmin3 or in the PostgreSQL shell to get familiar with the schema “pubmed”:</p>
<blockquote>
<ul>
<li><p>Find all substances related to pancreatic cancer, pancreatitis, etc.</p>
<blockquote>
<ul>
<li>select * from pubmed.tbl_chemical where lower(name_of_substance) LIKE 'pancreati%'; -- 177 lines</li>
</ul>
</blockquote></li>
<li><p>Find all MeSH terms with the substring “ancreat” and prefixes as well as suffixes.</p>
<blockquote>
<ul>
<li>select distinct on (descriptor_name) * from pubmed.tbl_mesh_heading where lower(descriptor_name) LIKE '%ancreat%'; -- 29 lines</li>
</ul>
</blockquote></li>
<li><p>What is the number of published titles in our database?</p>
<blockquote>
<ul>
<li>select count(*) from pubmed.tbl_medline_citation; -- 21482</li>
</ul>
</blockquote></li>
<li><p>How many publications contain an abstract?</p>
<blockquote>
<ul>
<li>select count(*) from pubmed.tbl_abstract; -- 19726</li>
</ul>
</blockquote></li>
<li><p>Show me all different journals and abbreviations referring to our topic.</p>
<blockquote>
<ul>
<li>select distinct on (title, iso_abbreviation) title, iso_abbreviation from pubmed.tbl_journal; -- 2096 lines</li>
</ul>
</blockquote></li>
<li><p>What is the number of publications since 1990?</p>
<blockquote>
<ul>
<li><p>select count(*) from pubmed.tbl_journal where pub_date_year &lt;=2000 and pub_date_year &gt;=1990; -- between 1990 and 2000: 3736 publications</p></li>
<li><p>select count(*) from pubmed.tbl_journal where pub_date_year &lt;=2010 and pub_date_year &gt;2000; -- after 2000 until 2010: 9286 publications</p></li>
<li><p>select count(*) from pubmed.tbl_journal where pub_date_year &gt;2010; -- after 2010: 6898 publications</p></li>
</ul>
</blockquote></li>
<li><p>What is the number of publications in USA referring to our topic?</p>
<blockquote>
<ul>
<li>select count(*) from pubmed.tbl_medline_journal_info where lower(country) = 'united states'; -- 9304 publications</li>
</ul>
</blockquote></li>
<li><p>I took the first publication for our query “pancreatic cancer” in the browser on NCBI and wanted to know whether this author has other publications. For our data set, this is not the case, because the query result is “1”.</p>
<blockquote>
<ul>
<li>select count (*) from pubmed.tbl_author where last_name = 'Iswanto'; -- 1 line</li>
</ul>
</blockquote></li>
</ul>
</blockquote></li>
</ul>
<h2 id="postgresql-and-xapian"><a href="#TOC"><span class="header-section-number">6.3</span> PostgreSQL and Xapian</a></h2>
<ul>
<li><p>The results of this subsection can be found in “full_text_index/results/results_from_documentation/”.</p></li>
<li><p>Try “python find_authors.py” to see an example for processing a PostgreSQL query in Python. Use “python find_authors.py -f &lt;output_filename&gt; -d &lt;name_of_database&gt;” to specify the name of the output file and the database to connect to. “python find_authors.py -h” shows all adjustable parameters.</p>
<blockquote>
<ul>
<li><p>Considering the output, Ralph H. Hruban has published the most articles with a number of 237 PubMed-IDs.</p>
<blockquote>
<ul>
<li>The other authors and their number of publications can be found in “results/authors.csv” in a descending order.</li>
</ul>
</blockquote></li>
<li><p>You can check the amount of publications from similiarly written author names in PGAdmin3 and then Helmut Friess is shown as the one with the most publications:</p>
<blockquote>
<ul>
<li><p>select distinct on(fk_pmid) * from pubmed.tbl_author where last_name = 'Friess' and (fore_name = 'H' or fore_name = 'Helmut') order by fk_pmid; -- 370</p></li>
<li><p>select distinct on(fk_pmid) * from pubmed.tbl_author where last_name = 'Büchler' and (fore_name = 'Markus W' or fore_name = 'M W') order by fk_pmid; -- 302</p></li>
<li><p>select distinct on(fk_pmid) * from pubmed.tbl_author where last_name = 'Hruban' and fore_name = 'Ralph H'; -- 237</p></li>
</ul>
</blockquote></li>
<li><p>It is possible that an author name exists twice although different persons are meant. This is not considered here.</p></li>
<li><p>There are examples in which you can only find a collective name:</p>
<blockquote>
<ul>
<li>select * from pubmed.tbl_author where last_name is NULL and fore_name is NULL; -- 249</li>
</ul>
</blockquote></li>
</ul>
</blockquote></li>
<li><p>Based on this, it is possible to consider whether the author Helmut Friess has published something containing the query terms from the list in “synonyms/pancreatic_cancer.txt”:</p>
<blockquote>
<ul>
<li><p>Type in “python find_topics.py”. You can try “python find_topics.py -h”, to see which parameters can be varied, e.g. if your input filename is not “pmids_results.csv” or if you want to specify your output filename, which default is “pmids_results_from_author.csv”.</p>
<blockquote>
<ul>
<li><p>123 publications were found for the given list of synonyms and this author.</p></li>
<li><p>The main research topic seems to be pancreatic ductal adenocarcinoma. This result can be compared with the outputs using other author names (hard coded in “find_topics.py”) and running “find_topics.py” with another filename, again.</p></li>
</ul>
</blockquote></li>
</ul>
</blockquote></li>
<li><p>Next steps can be to select the abstracts that were identified with Xapian from PostgreSQL and to use a sentence tokeniser. Like this, groups of words and semantic structures can be analysed with natural language processing methods.</p></li>
</ul>
<h1 id="contact"><a href="#TOC"><span class="header-section-number">7</span> Contact</a></h1>
<ul>
<li><p>Please, write an e-mail, if you have questions, feedback, improvements, or new ideas:</p>
<blockquote>
<ul>
<li><script type="text/javascript">
<!--
h='&#112;&#104;&#x61;&#114;&#x6d;&#x61;&#122;&#x69;&#x65;&#46;&#x75;&#110;&#x69;&#x2d;&#102;&#114;&#x65;&#x69;&#98;&#x75;&#114;&#x67;&#46;&#100;&#x65;';a='&#64;';n='&#x6b;&#x65;&#114;&#x73;&#116;&#x65;&#110;&#46;&#100;&#x6f;&#x65;&#114;&#x69;&#110;&#x67;';e=n+a+h;
document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'">'+'<code>'+e+'</code>'+'<\/'+'a'+'>');
// -->
</script><noscript>&#x6b;&#x65;&#114;&#x73;&#116;&#x65;&#110;&#46;&#100;&#x6f;&#x65;&#114;&#x69;&#110;&#x67;&#32;&#x61;&#116;&#32;&#112;&#104;&#x61;&#114;&#x6d;&#x61;&#122;&#x69;&#x65;&#32;&#100;&#x6f;&#116;&#32;&#x75;&#110;&#x69;&#x2d;&#102;&#114;&#x65;&#x69;&#98;&#x75;&#114;&#x67;&#32;&#100;&#x6f;&#116;&#32;&#100;&#x65;</noscript></li>
</ul>
</blockquote></li>
<li><p>If you are interested in related projects, visit our working group’s homepage:</p>
<blockquote>
<ul>
<li><a href="http://www.pharmaceutical-bioinformatics.de">http://www.pharmaceutical-bioinformatics.de</a></li>
</ul>
</blockquote></li>
</ul>
<h2 id="license"><a href="#TOC"><span class="header-section-number">7.1</span> License</a></h2>
<ul>
<li>PubMed2Go is published with an ISC license given in “license.txt”.</li>
</ul>
</body>
</html>
